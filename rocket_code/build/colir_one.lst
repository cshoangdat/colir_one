ARM GAS  /tmp/ccjM7rvG.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"colir_one.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.file 1 "Core/Src/colir_one.c"
  20              		.section	.text.colir_one_init,"ax",%progbits
  21              		.align	1
  22              		.global	colir_one_init
  23              		.syntax unified
  24              		.thumb
  25              		.thumb_func
  27              	colir_one_init:
  28              	.LVL0:
  29              	.LFB137:
   1:Core/Src/colir_one.c **** #include "main.h"
   2:Core/Src/colir_one.c **** #include "w25qxx.h"
   3:Core/Src/colir_one.c **** #include "fatfs.h"
   4:Core/Src/colir_one.c **** #include "colir_one.h"
   5:Core/Src/colir_one.c **** #include "string.h"
   6:Core/Src/colir_one.c **** #include <stdio.h>
   7:Core/Src/colir_one.c **** 
   8:Core/Src/colir_one.c **** #define LOG_SIZE 32
   9:Core/Src/colir_one.c **** #define LOG_BUF_SIZE 32
  10:Core/Src/colir_one.c **** #define PAGE_SIZE LOG_SIZE * LOG_BUF_SIZE
  11:Core/Src/colir_one.c **** #define CONFIG_SIZE 2048
  12:Core/Src/colir_one.c **** #define SPI1_CS_GPIO_Port GPIOD
  13:Core/Src/colir_one.c **** #define SPI1_CS_Pin GPIO_PIN_7
  14:Core/Src/colir_one.c **** 
  15:Core/Src/colir_one.c **** W25QXX_HandleTypeDef w25qxx;
  16:Core/Src/colir_one.c **** uint32_t sectors;
  17:Core/Src/colir_one.c **** uint32_t flash_size;
  18:Core/Src/colir_one.c **** 
  19:Core/Src/colir_one.c **** uint8_t buf[LOG_SIZE];
  20:Core/Src/colir_one.c **** uint8_t log_buf[LOG_BUF_SIZE][LOG_SIZE];
  21:Core/Src/colir_one.c **** uint8_t config_buf[CONFIG_SIZE];
  22:Core/Src/colir_one.c **** flash_config* logs_config;
  23:Core/Src/colir_one.c **** 
  24:Core/Src/colir_one.c **** uint8_t logs_buf_counter = 0;
  25:Core/Src/colir_one.c **** 
  26:Core/Src/colir_one.c **** uint8_t current_log = 255;
  27:Core/Src/colir_one.c **** uint32_t current_address;
  28:Core/Src/colir_one.c **** uint16_t log_buf_counter = 0;
  29:Core/Src/colir_one.c **** 
ARM GAS  /tmp/ccjM7rvG.s 			page 2


  30:Core/Src/colir_one.c **** W25QXX_result_t res;
  31:Core/Src/colir_one.c **** 
  32:Core/Src/colir_one.c **** void colir_one_init(SPI_HandleTypeDef *hspi) {
  30              		.loc 1 32 46 view -0
  31              		.cfi_startproc
  32              		@ args = 0, pretend = 0, frame = 0
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  34              		.loc 1 32 46 is_stmt 0 view .LVU1
  35 0000 70B5     		push	{r4, r5, r6, lr}
  36              	.LCFI0:
  37              		.cfi_def_cfa_offset 16
  38              		.cfi_offset 4, -16
  39              		.cfi_offset 5, -12
  40              		.cfi_offset 6, -8
  41              		.cfi_offset 14, -4
  42 0002 0446     		mov	r4, r0
  33:Core/Src/colir_one.c **** 	if(hspi->State != HAL_SPI_STATE_READY)
  43              		.loc 1 33 2 is_stmt 1 view .LVU2
  44              		.loc 1 33 9 is_stmt 0 view .LVU3
  45 0004 90F85130 		ldrb	r3, [r0, #81]	@ zero_extendqisi2
  46 0008 DBB2     		uxtb	r3, r3
  47              		.loc 1 33 4 view .LVU4
  48 000a 012B     		cmp	r3, #1
  49 000c 27D1     		bne	.L5
  50              	.LVL1:
  51              	.L2:
  34:Core/Src/colir_one.c **** 		HAL_SPI_Init(hspi);
  35:Core/Src/colir_one.c **** 
  36:Core/Src/colir_one.c **** 	res = w25qxx_init(&w25qxx, hspi, SPI1_CS_GPIO_Port, SPI1_CS_Pin);
  52              		.loc 1 36 2 is_stmt 1 view .LVU5
  53              		.loc 1 36 8 is_stmt 0 view .LVU6
  54 000e 1B4D     		ldr	r5, .L7
  55 0010 8023     		movs	r3, #128
  56 0012 1B4A     		ldr	r2, .L7+4
  57 0014 2146     		mov	r1, r4
  58 0016 2846     		mov	r0, r5
  59 0018 FFF7FEFF 		bl	w25qxx_init
  60              	.LVL2:
  61              		.loc 1 36 6 view .LVU7
  62 001c 194B     		ldr	r3, .L7+8
  63 001e 1870     		strb	r0, [r3]
  37:Core/Src/colir_one.c **** 
  38:Core/Src/colir_one.c **** 	sectors = w25qxx.block_count * w25qxx.sectors_in_block;
  64              		.loc 1 38 2 is_stmt 1 view .LVU8
  65              		.loc 1 38 18 is_stmt 0 view .LVU9
  66 0020 6B69     		ldr	r3, [r5, #20]
  67              		.loc 1 38 39 view .LVU10
  68 0022 EA69     		ldr	r2, [r5, #28]
  69              		.loc 1 38 31 view .LVU11
  70 0024 03FB02F2 		mul	r2, r3, r2
  71              		.loc 1 38 10 view .LVU12
  72 0028 1749     		ldr	r1, .L7+12
  73 002a 0A60     		str	r2, [r1]
  39:Core/Src/colir_one.c **** 	flash_size = w25qxx.block_count * w25qxx.block_size;
  74              		.loc 1 39 2 is_stmt 1 view .LVU13
  75              		.loc 1 39 42 is_stmt 0 view .LVU14
  76 002c 2A69     		ldr	r2, [r5, #16]
ARM GAS  /tmp/ccjM7rvG.s 			page 3


  77              		.loc 1 39 34 view .LVU15
  78 002e 02FB03F3 		mul	r3, r2, r3
  79              		.loc 1 39 13 view .LVU16
  80 0032 164A     		ldr	r2, .L7+16
  81 0034 1360     		str	r3, [r2]
  40:Core/Src/colir_one.c **** 	//w25qxx_chip_erase(&w25qxx);
  41:Core/Src/colir_one.c **** 	w25qxx_read(&w25qxx, 0, (uint8_t*)&config_buf, sizeof(config_buf));
  82              		.loc 1 41 2 is_stmt 1 view .LVU17
  83 0036 164E     		ldr	r6, .L7+20
  84 0038 4FF40063 		mov	r3, #2048
  85 003c 3246     		mov	r2, r6
  86 003e 0021     		movs	r1, #0
  87 0040 2846     		mov	r0, r5
  88 0042 FFF7FEFF 		bl	w25qxx_read
  89              	.LVL3:
  42:Core/Src/colir_one.c **** 
  43:Core/Src/colir_one.c **** 	logs_config = (flash_config*)config_buf;
  90              		.loc 1 43 2 view .LVU18
  91              		.loc 1 43 14 is_stmt 0 view .LVU19
  92 0046 134B     		ldr	r3, .L7+24
  93 0048 1E60     		str	r6, [r3]
  44:Core/Src/colir_one.c **** 	if(logs_config->last_log == 0 || logs_config->last_log == 255){
  94              		.loc 1 44 2 is_stmt 1 view .LVU20
  95              		.loc 1 44 16 is_stmt 0 view .LVU21
  96 004a 96F88430 		ldrb	r3, [r6, #132]	@ zero_extendqisi2
  97              		.loc 1 44 32 view .LVU22
  98 004e 013B     		subs	r3, r3, #1
  99 0050 DBB2     		uxtb	r3, r3
 100              		.loc 1 44 4 view .LVU23
 101 0052 FD2B     		cmp	r3, #253
 102 0054 06D8     		bhi	.L6
 103              	.L3:
  45:Core/Src/colir_one.c **** 		logs_config->last_log = 0;
  46:Core/Src/colir_one.c **** 		logs_config->last_address = CONFIG_SIZE;
  47:Core/Src/colir_one.c **** 		memset(&logs_config->log_address, 0, sizeof(logs_config->log_address));
  48:Core/Src/colir_one.c **** 	}
  49:Core/Src/colir_one.c **** 
  50:Core/Src/colir_one.c **** 	HAL_SPI_DeInit(hspi);
 104              		.loc 1 50 2 is_stmt 1 view .LVU24
 105 0056 2046     		mov	r0, r4
 106 0058 FFF7FEFF 		bl	HAL_SPI_DeInit
 107              	.LVL4:
  51:Core/Src/colir_one.c **** }
 108              		.loc 1 51 1 is_stmt 0 view .LVU25
 109 005c 70BD     		pop	{r4, r5, r6, pc}
 110              	.LVL5:
 111              	.L5:
  34:Core/Src/colir_one.c **** 
 112              		.loc 1 34 3 is_stmt 1 view .LVU26
 113 005e FFF7FEFF 		bl	HAL_SPI_Init
 114              	.LVL6:
  34:Core/Src/colir_one.c **** 
 115              		.loc 1 34 3 is_stmt 0 view .LVU27
 116 0062 D4E7     		b	.L2
 117              	.L6:
  45:Core/Src/colir_one.c **** 		logs_config->last_log = 0;
 118              		.loc 1 45 3 is_stmt 1 view .LVU28
ARM GAS  /tmp/ccjM7rvG.s 			page 4


  45:Core/Src/colir_one.c **** 		logs_config->last_log = 0;
 119              		.loc 1 45 25 is_stmt 0 view .LVU29
 120 0064 3046     		mov	r0, r6
 121 0066 0021     		movs	r1, #0
 122 0068 86F88410 		strb	r1, [r6, #132]
  46:Core/Src/colir_one.c **** 		memset(&logs_config->log_address, 0, sizeof(logs_config->log_address));
 123              		.loc 1 46 3 is_stmt 1 view .LVU30
  46:Core/Src/colir_one.c **** 		memset(&logs_config->log_address, 0, sizeof(logs_config->log_address));
 124              		.loc 1 46 29 is_stmt 0 view .LVU31
 125 006c 4FF40063 		mov	r3, #2048
 126 0070 40F8043B 		str	r3, [r0], #4
  47:Core/Src/colir_one.c **** 	}
 127              		.loc 1 47 3 is_stmt 1 view .LVU32
 128 0074 8022     		movs	r2, #128
 129 0076 FFF7FEFF 		bl	memset
 130              	.LVL7:
 131 007a ECE7     		b	.L3
 132              	.L8:
 133              		.align	2
 134              	.L7:
 135 007c 00000000 		.word	w25qxx
 136 0080 000C0240 		.word	1073875968
 137 0084 00000000 		.word	res
 138 0088 00000000 		.word	sectors
 139 008c 00000000 		.word	flash_size
 140 0090 00000000 		.word	config_buf
 141 0094 00000000 		.word	logs_config
 142              		.cfi_endproc
 143              	.LFE137:
 145              		.section	.text.log_data,"ax",%progbits
 146              		.align	1
 147              		.global	log_data
 148              		.syntax unified
 149              		.thumb
 150              		.thumb_func
 152              	log_data:
 153              	.LVL8:
 154              	.LFB138:
  52:Core/Src/colir_one.c **** 
  53:Core/Src/colir_one.c **** void log_data(char cmd[]){
 155              		.loc 1 53 26 view -0
 156              		.cfi_startproc
 157              		@ args = 0, pretend = 0, frame = 0
 158              		@ frame_needed = 0, uses_anonymous_args = 0
 159              		.loc 1 53 26 is_stmt 0 view .LVU34
 160 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 161              	.LCFI1:
 162              		.cfi_def_cfa_offset 24
 163              		.cfi_offset 3, -24
 164              		.cfi_offset 4, -20
 165              		.cfi_offset 5, -16
 166              		.cfi_offset 6, -12
 167              		.cfi_offset 7, -8
 168              		.cfi_offset 14, -4
  54:Core/Src/colir_one.c **** 	memcpy(&log_buf[log_buf_counter], cmd, sizeof(log_buf[log_buf_counter]));
 169              		.loc 1 54 2 is_stmt 1 view .LVU35
 170              		.loc 1 54 17 is_stmt 0 view .LVU36
ARM GAS  /tmp/ccjM7rvG.s 			page 5


 171 0002 514D     		ldr	r5, .L19
 172 0004 2B88     		ldrh	r3, [r5]
 173              		.loc 1 54 9 view .LVU37
 174 0006 5F01     		lsls	r7, r3, #5
 175 0008 504E     		ldr	r6, .L19+4
 176 000a 06EB4312 		add	r2, r6, r3, lsl #5
 177              		.loc 1 54 2 view .LVU38
 178 000e 0468     		ldr	r4, [r0]	@ unaligned
 179 0010 D0F804E0 		ldr	lr, [r0, #4]	@ unaligned
 180 0014 D0F808C0 		ldr	ip, [r0, #8]	@ unaligned
 181 0018 C168     		ldr	r1, [r0, #12]	@ unaligned
 182 001a F451     		str	r4, [r6, r7]	@ unaligned
 183 001c C2F804E0 		str	lr, [r2, #4]	@ unaligned
 184 0020 C2F808C0 		str	ip, [r2, #8]	@ unaligned
 185 0024 D160     		str	r1, [r2, #12]	@ unaligned
 186 0026 0469     		ldr	r4, [r0, #16]	@ unaligned
 187 0028 D0F814E0 		ldr	lr, [r0, #20]	@ unaligned
 188 002c D0F818C0 		ldr	ip, [r0, #24]	@ unaligned
 189 0030 C169     		ldr	r1, [r0, #28]	@ unaligned
 190 0032 1461     		str	r4, [r2, #16]	@ unaligned
 191 0034 C2F814E0 		str	lr, [r2, #20]	@ unaligned
 192 0038 C2F818C0 		str	ip, [r2, #24]	@ unaligned
 193 003c D161     		str	r1, [r2, #28]	@ unaligned
  55:Core/Src/colir_one.c **** 	log_buf_counter++;
 194              		.loc 1 55 2 is_stmt 1 view .LVU39
 195              		.loc 1 55 17 is_stmt 0 view .LVU40
 196 003e 0133     		adds	r3, r3, #1
 197 0040 9BB2     		uxth	r3, r3
 198 0042 2B80     		strh	r3, [r5]	@ movhi
  56:Core/Src/colir_one.c **** 	if(log_buf_counter >= LOG_BUF_SIZE){
 199              		.loc 1 56 2 is_stmt 1 view .LVU41
 200              		.loc 1 56 4 is_stmt 0 view .LVU42
 201 0044 1F2B     		cmp	r3, #31
 202 0046 4CD9     		bls	.L9
  57:Core/Src/colir_one.c **** 		if(w25qxx.spiHandle->State != HAL_SPI_STATE_READY)
 203              		.loc 1 57 3 is_stmt 1 view .LVU43
 204              		.loc 1 57 12 is_stmt 0 view .LVU44
 205 0048 414B     		ldr	r3, .L19+8
 206 004a 1868     		ldr	r0, [r3]
 207              	.LVL9:
 208              		.loc 1 57 22 view .LVU45
 209 004c 90F85130 		ldrb	r3, [r0, #81]	@ zero_extendqisi2
 210 0050 DBB2     		uxtb	r3, r3
 211              		.loc 1 57 5 view .LVU46
 212 0052 012B     		cmp	r3, #1
 213 0054 46D1     		bne	.L16
 214              	.L11:
  58:Core/Src/colir_one.c **** 			HAL_SPI_Init(w25qxx.spiHandle);
  59:Core/Src/colir_one.c **** 
  60:Core/Src/colir_one.c **** 		log_buf_counter = 0;
 215              		.loc 1 60 3 is_stmt 1 view .LVU47
 216              		.loc 1 60 19 is_stmt 0 view .LVU48
 217 0056 3C4B     		ldr	r3, .L19
 218 0058 0022     		movs	r2, #0
 219 005a 1A80     		strh	r2, [r3]	@ movhi
  61:Core/Src/colir_one.c **** 
  62:Core/Src/colir_one.c **** 		current_address = logs_config->last_address;
ARM GAS  /tmp/ccjM7rvG.s 			page 6


 220              		.loc 1 62 3 is_stmt 1 view .LVU49
 221              		.loc 1 62 32 is_stmt 0 view .LVU50
 222 005c 3D4B     		ldr	r3, .L19+12
 223 005e 1B68     		ldr	r3, [r3]
 224 0060 1968     		ldr	r1, [r3]
 225              		.loc 1 62 19 view .LVU51
 226 0062 3D4D     		ldr	r5, .L19+16
 227 0064 2960     		str	r1, [r5]
  63:Core/Src/colir_one.c **** 		//logs_config->last_address = current_address;
  64:Core/Src/colir_one.c **** 
  65:Core/Src/colir_one.c **** 		res = w25qxx_erase(&w25qxx, current_address, sizeof(log_buf));
 228              		.loc 1 65 3 is_stmt 1 view .LVU52
 229              		.loc 1 65 9 is_stmt 0 view .LVU53
 230 0066 3A4C     		ldr	r4, .L19+8
 231 0068 4FF48062 		mov	r2, #1024
 232 006c 2046     		mov	r0, r4
 233 006e FFF7FEFF 		bl	w25qxx_erase
 234              	.LVL10:
 235              		.loc 1 65 7 view .LVU54
 236 0072 3A4F     		ldr	r7, .L19+20
 237 0074 3870     		strb	r0, [r7]
  66:Core/Src/colir_one.c **** 		HAL_Delay(35);
 238              		.loc 1 66 3 is_stmt 1 view .LVU55
 239 0076 2320     		movs	r0, #35
 240 0078 FFF7FEFF 		bl	HAL_Delay
 241              	.LVL11:
  67:Core/Src/colir_one.c **** 		res = w25qxx_write(&w25qxx, current_address, (uint8_t*)&log_buf, sizeof(log_buf));
 242              		.loc 1 67 3 view .LVU56
 243              		.loc 1 67 9 is_stmt 0 view .LVU57
 244 007c 334E     		ldr	r6, .L19+4
 245 007e 4FF48063 		mov	r3, #1024
 246 0082 3246     		mov	r2, r6
 247 0084 2968     		ldr	r1, [r5]
 248 0086 2046     		mov	r0, r4
 249 0088 FFF7FEFF 		bl	w25qxx_write
 250              	.LVL12:
 251              		.loc 1 67 7 view .LVU58
 252 008c 3870     		strb	r0, [r7]
  68:Core/Src/colir_one.c **** 		HAL_Delay(35);
 253              		.loc 1 68 3 is_stmt 1 view .LVU59
 254 008e 2320     		movs	r0, #35
 255 0090 FFF7FEFF 		bl	HAL_Delay
 256              	.LVL13:
  69:Core/Src/colir_one.c **** 		w25qxx_read(&w25qxx, current_address, (uint8_t*)&log_buf, sizeof(log_buf));
 257              		.loc 1 69 3 view .LVU60
 258 0094 4FF48063 		mov	r3, #1024
 259 0098 3246     		mov	r2, r6
 260 009a 2968     		ldr	r1, [r5]
 261 009c 2046     		mov	r0, r4
 262 009e FFF7FEFF 		bl	w25qxx_read
 263              	.LVL14:
  70:Core/Src/colir_one.c **** 
  71:Core/Src/colir_one.c **** 		if(current_log == 255){
 264              		.loc 1 71 3 view .LVU61
 265              		.loc 1 71 18 is_stmt 0 view .LVU62
 266 00a2 2F4B     		ldr	r3, .L19+24
 267 00a4 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
ARM GAS  /tmp/ccjM7rvG.s 			page 7


 268              		.loc 1 71 5 view .LVU63
 269 00a6 FF2B     		cmp	r3, #255
 270 00a8 1FD0     		beq	.L17
 271              	.L12:
  72:Core/Src/colir_one.c **** 			current_log = logs_config->last_log + 1;
  73:Core/Src/colir_one.c **** 			if(current_log >= 32)
  74:Core/Src/colir_one.c **** 				current_log = 1;
  75:Core/Src/colir_one.c **** 			logs_config->last_log = current_log;
  76:Core/Src/colir_one.c **** 		}
  77:Core/Src/colir_one.c **** 
  78:Core/Src/colir_one.c **** 		current_address += PAGE_SIZE;
 272              		.loc 1 78 3 is_stmt 1 view .LVU64
 273              		.loc 1 78 19 is_stmt 0 view .LVU65
 274 00aa 2B4A     		ldr	r2, .L19+16
 275 00ac 1368     		ldr	r3, [r2]
 276 00ae 03F58063 		add	r3, r3, #1024
 277 00b2 1360     		str	r3, [r2]
  79:Core/Src/colir_one.c **** 		logs_config->last_address = current_address;
 278              		.loc 1 79 3 is_stmt 1 view .LVU66
 279              		.loc 1 79 14 is_stmt 0 view .LVU67
 280 00b4 274A     		ldr	r2, .L19+12
 281 00b6 1168     		ldr	r1, [r2]
 282              		.loc 1 79 29 view .LVU68
 283 00b8 0B60     		str	r3, [r1]
  80:Core/Src/colir_one.c **** 		logs_config->log_address[current_log - 1] = current_address;
 284              		.loc 1 80 3 is_stmt 1 view .LVU69
 285              		.loc 1 80 14 is_stmt 0 view .LVU70
 286 00ba 1268     		ldr	r2, [r2]
 287              		.loc 1 80 40 view .LVU71
 288 00bc 2849     		ldr	r1, .L19+24
 289 00be 0978     		ldrb	r1, [r1]	@ zero_extendqisi2
 290 00c0 0139     		subs	r1, r1, #1
 291              		.loc 1 80 45 view .LVU72
 292 00c2 02EB8102 		add	r2, r2, r1, lsl #2
 293 00c6 5360     		str	r3, [r2, #4]
  81:Core/Src/colir_one.c **** 
  82:Core/Src/colir_one.c **** 		res = w25qxx_erase(&w25qxx, 0, sizeof(config_buf));
 294              		.loc 1 82 3 is_stmt 1 view .LVU73
 295              		.loc 1 82 9 is_stmt 0 view .LVU74
 296 00c8 4FF40062 		mov	r2, #2048
 297 00cc 0021     		movs	r1, #0
 298 00ce 2048     		ldr	r0, .L19+8
 299 00d0 FFF7FEFF 		bl	w25qxx_erase
 300              	.LVL15:
 301              		.loc 1 82 7 view .LVU75
 302 00d4 214B     		ldr	r3, .L19+20
 303 00d6 1870     		strb	r0, [r3]
  83:Core/Src/colir_one.c **** 		if(res == W25QXX_Ok){
 304              		.loc 1 83 3 is_stmt 1 view .LVU76
 305              		.loc 1 83 5 is_stmt 0 view .LVU77
 306 00d8 C8B1     		cbz	r0, .L18
 307              	.L14:
  84:Core/Src/colir_one.c **** 
  85:Core/Src/colir_one.c **** 			memcpy(&config_buf, (uint8_t*)logs_config, sizeof(config_buf));
  86:Core/Src/colir_one.c **** 			res = w25qxx_write(&w25qxx, 0, (uint8_t*)&config_buf, sizeof(config_buf));
  87:Core/Src/colir_one.c **** 			HAL_Delay(35);
  88:Core/Src/colir_one.c **** 			w25qxx_read(&w25qxx, 0, (uint8_t*)&config_buf, sizeof(config_buf));
ARM GAS  /tmp/ccjM7rvG.s 			page 8


  89:Core/Src/colir_one.c **** 		}
  90:Core/Src/colir_one.c **** 
  91:Core/Src/colir_one.c **** 		HAL_SPI_DeInit(w25qxx.spiHandle);
 308              		.loc 1 91 3 is_stmt 1 view .LVU78
 309 00da 1D4B     		ldr	r3, .L19+8
 310 00dc 1868     		ldr	r0, [r3]
 311 00de FFF7FEFF 		bl	HAL_SPI_DeInit
 312              	.LVL16:
 313              	.L9:
  92:Core/Src/colir_one.c **** 	}
  93:Core/Src/colir_one.c **** }
 314              		.loc 1 93 1 is_stmt 0 view .LVU79
 315 00e2 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 316              	.L16:
  58:Core/Src/colir_one.c **** 
 317              		.loc 1 58 4 is_stmt 1 view .LVU80
 318 00e4 FFF7FEFF 		bl	HAL_SPI_Init
 319              	.LVL17:
 320 00e8 B5E7     		b	.L11
 321              	.L17:
  72:Core/Src/colir_one.c **** 			if(current_log >= 32)
 322              		.loc 1 72 4 view .LVU81
  72:Core/Src/colir_one.c **** 			if(current_log >= 32)
 323              		.loc 1 72 29 is_stmt 0 view .LVU82
 324 00ea 1A4B     		ldr	r3, .L19+12
 325 00ec 1A68     		ldr	r2, [r3]
 326 00ee 92F88430 		ldrb	r3, [r2, #132]	@ zero_extendqisi2
  72:Core/Src/colir_one.c **** 			if(current_log >= 32)
 327              		.loc 1 72 40 view .LVU83
 328 00f2 0133     		adds	r3, r3, #1
 329 00f4 DBB2     		uxtb	r3, r3
  72:Core/Src/colir_one.c **** 			if(current_log >= 32)
 330              		.loc 1 72 16 view .LVU84
 331 00f6 1A49     		ldr	r1, .L19+24
 332 00f8 0B70     		strb	r3, [r1]
  73:Core/Src/colir_one.c **** 				current_log = 1;
 333              		.loc 1 73 4 is_stmt 1 view .LVU85
  73:Core/Src/colir_one.c **** 				current_log = 1;
 334              		.loc 1 73 6 is_stmt 0 view .LVU86
 335 00fa 1F2B     		cmp	r3, #31
 336 00fc 02D9     		bls	.L13
  74:Core/Src/colir_one.c **** 			logs_config->last_log = current_log;
 337              		.loc 1 74 5 is_stmt 1 view .LVU87
  74:Core/Src/colir_one.c **** 			logs_config->last_log = current_log;
 338              		.loc 1 74 17 is_stmt 0 view .LVU88
 339 00fe 0B46     		mov	r3, r1
 340 0100 0121     		movs	r1, #1
 341 0102 1970     		strb	r1, [r3]
 342              	.L13:
  75:Core/Src/colir_one.c **** 		}
 343              		.loc 1 75 4 is_stmt 1 view .LVU89
  75:Core/Src/colir_one.c **** 		}
 344              		.loc 1 75 26 is_stmt 0 view .LVU90
 345 0104 164B     		ldr	r3, .L19+24
 346 0106 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 347 0108 82F88430 		strb	r3, [r2, #132]
 348 010c CDE7     		b	.L12
ARM GAS  /tmp/ccjM7rvG.s 			page 9


 349              	.L18:
  85:Core/Src/colir_one.c **** 			res = w25qxx_write(&w25qxx, 0, (uint8_t*)&config_buf, sizeof(config_buf));
 350              		.loc 1 85 4 is_stmt 1 view .LVU91
 351 010e 154C     		ldr	r4, .L19+28
 352 0110 4FF40065 		mov	r5, #2048
 353 0114 2A46     		mov	r2, r5
 354 0116 0F4B     		ldr	r3, .L19+12
 355 0118 1968     		ldr	r1, [r3]
 356 011a 2046     		mov	r0, r4
 357 011c FFF7FEFF 		bl	memcpy
 358              	.LVL18:
  86:Core/Src/colir_one.c **** 			HAL_Delay(35);
 359              		.loc 1 86 4 view .LVU92
  86:Core/Src/colir_one.c **** 			HAL_Delay(35);
 360              		.loc 1 86 10 is_stmt 0 view .LVU93
 361 0120 0B4E     		ldr	r6, .L19+8
 362 0122 2B46     		mov	r3, r5
 363 0124 2246     		mov	r2, r4
 364 0126 0021     		movs	r1, #0
 365 0128 3046     		mov	r0, r6
 366 012a FFF7FEFF 		bl	w25qxx_write
 367              	.LVL19:
  86:Core/Src/colir_one.c **** 			HAL_Delay(35);
 368              		.loc 1 86 8 view .LVU94
 369 012e 0B4B     		ldr	r3, .L19+20
 370 0130 1870     		strb	r0, [r3]
  87:Core/Src/colir_one.c **** 			w25qxx_read(&w25qxx, 0, (uint8_t*)&config_buf, sizeof(config_buf));
 371              		.loc 1 87 4 is_stmt 1 view .LVU95
 372 0132 2320     		movs	r0, #35
 373 0134 FFF7FEFF 		bl	HAL_Delay
 374              	.LVL20:
  88:Core/Src/colir_one.c **** 		}
 375              		.loc 1 88 4 view .LVU96
 376 0138 2B46     		mov	r3, r5
 377 013a 2246     		mov	r2, r4
 378 013c 0021     		movs	r1, #0
 379 013e 3046     		mov	r0, r6
 380 0140 FFF7FEFF 		bl	w25qxx_read
 381              	.LVL21:
 382 0144 C9E7     		b	.L14
 383              	.L20:
 384 0146 00BF     		.align	2
 385              	.L19:
 386 0148 00000000 		.word	log_buf_counter
 387 014c 00000000 		.word	log_buf
 388 0150 00000000 		.word	w25qxx
 389 0154 00000000 		.word	logs_config
 390 0158 00000000 		.word	current_address
 391 015c 00000000 		.word	res
 392 0160 00000000 		.word	current_log
 393 0164 00000000 		.word	config_buf
 394              		.cfi_endproc
 395              	.LFE138:
 397              		.section	.rodata.read_logs_to_sd.str1.4,"aMS",%progbits,1
 398              		.align	2
 399              	.LC0:
 400 0000 25642E74 		.ascii	"%d.txt\000"
ARM GAS  /tmp/ccjM7rvG.s 			page 10


 400      787400
 401              		.section	.text.read_logs_to_sd,"ax",%progbits
 402              		.align	1
 403              		.global	read_logs_to_sd
 404              		.syntax unified
 405              		.thumb
 406              		.thumb_func
 408              	read_logs_to_sd:
 409              	.LFB139:
  94:Core/Src/colir_one.c **** 
  95:Core/Src/colir_one.c **** FRESULT FR_Status;
  96:Core/Src/colir_one.c **** char end_of_the_line[2] = "\n";
  97:Core/Src/colir_one.c **** 
  98:Core/Src/colir_one.c **** void read_logs_to_sd(){
 410              		.loc 1 98 23 view -0
 411              		.cfi_startproc
 412              		@ args = 0, pretend = 0, frame = 64
 413              		@ frame_needed = 0, uses_anonymous_args = 0
 414 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 415              	.LCFI2:
 416              		.cfi_def_cfa_offset 24
 417              		.cfi_offset 4, -24
 418              		.cfi_offset 5, -20
 419              		.cfi_offset 6, -16
 420              		.cfi_offset 7, -12
 421              		.cfi_offset 8, -8
 422              		.cfi_offset 14, -4
 423 0004 90B0     		sub	sp, sp, #64
 424              	.LCFI3:
 425              		.cfi_def_cfa_offset 88
  99:Core/Src/colir_one.c **** 	FR_Status = f_mount(&SDFatFS, SDPath, 1);
 426              		.loc 1 99 2 view .LVU98
 427              		.loc 1 99 14 is_stmt 0 view .LVU99
 428 0006 0122     		movs	r2, #1
 429 0008 3349     		ldr	r1, .L37
 430 000a 3448     		ldr	r0, .L37+4
 431 000c FFF7FEFF 		bl	f_mount
 432              	.LVL22:
 433              		.loc 1 99 12 view .LVU100
 434 0010 334B     		ldr	r3, .L37+8
 435 0012 1870     		strb	r0, [r3]
 100:Core/Src/colir_one.c **** 	if(FR_Status == FR_OK){
 436              		.loc 1 100 2 is_stmt 1 view .LVU101
 437              		.loc 1 100 4 is_stmt 0 view .LVU102
 438 0014 10B1     		cbz	r0, .L33
 439              	.L21:
 101:Core/Src/colir_one.c **** 		DIR dir;
 102:Core/Src/colir_one.c **** 		uint32_t lastAddress = CONFIG_SIZE;
 103:Core/Src/colir_one.c **** 		uint32_t currentReadAdress = CONFIG_SIZE;
 104:Core/Src/colir_one.c **** 		FR_Status = f_opendir(&dir, SDPath);
 105:Core/Src/colir_one.c **** 		if(FR_Status == FR_OK) {
 106:Core/Src/colir_one.c **** 			if(w25qxx.spiHandle->State != HAL_SPI_STATE_READY)
 107:Core/Src/colir_one.c **** 				HAL_SPI_Init(w25qxx.spiHandle);
 108:Core/Src/colir_one.c **** 
 109:Core/Src/colir_one.c **** 			for(uint8_t i = 1; i <= logs_config->last_log; i++){
 110:Core/Src/colir_one.c **** 				if(i < logs_config->last_log)
 111:Core/Src/colir_one.c **** 					lastAddress = logs_config->log_address[i];
ARM GAS  /tmp/ccjM7rvG.s 			page 11


 112:Core/Src/colir_one.c **** 				else
 113:Core/Src/colir_one.c **** 					lastAddress = logs_config->last_address;
 114:Core/Src/colir_one.c **** 
 115:Core/Src/colir_one.c **** 				char fileName[8];
 116:Core/Src/colir_one.c **** 				memset(&fileName, 0, sizeof(fileName));
 117:Core/Src/colir_one.c **** 				sprintf(fileName, "%d.txt", i);
 118:Core/Src/colir_one.c **** 				FR_Status = f_open(&SDFile, fileName, FA_WRITE | FA_READ | FA_CREATE_ALWAYS);
 119:Core/Src/colir_one.c **** 				if(FR_Status == FR_OK){
 120:Core/Src/colir_one.c **** 					currentReadAdress = logs_config->log_address[i - 1];
 121:Core/Src/colir_one.c **** 					for(uint32_t address = currentReadAdress; address < lastAddress; address += LOG_SIZE){
 122:Core/Src/colir_one.c **** 						w25qxx_read(&w25qxx, address, (uint8_t*)&buf, sizeof(buf));
 123:Core/Src/colir_one.c **** 						f_puts(&buf, &SDFile);
 124:Core/Src/colir_one.c **** 						f_puts(&end_of_the_line, &SDFile);
 125:Core/Src/colir_one.c **** 					}
 126:Core/Src/colir_one.c **** 					f_close(&SDFile);
 127:Core/Src/colir_one.c **** 				}
 128:Core/Src/colir_one.c **** 			}
 129:Core/Src/colir_one.c **** 			HAL_SPI_DeInit(w25qxx.spiHandle);
 130:Core/Src/colir_one.c **** 		}
 131:Core/Src/colir_one.c **** 		f_mount(&SDFatFS, (TCHAR const*)NULL, 0);
 132:Core/Src/colir_one.c **** 	}
 133:Core/Src/colir_one.c **** }
 440              		.loc 1 133 1 view .LVU103
 441 0016 10B0     		add	sp, sp, #64
 442              	.LCFI4:
 443              		.cfi_remember_state
 444              		.cfi_def_cfa_offset 24
 445              		@ sp needed
 446 0018 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 447              	.L33:
 448              	.LCFI5:
 449              		.cfi_restore_state
 450              	.LBB2:
 101:Core/Src/colir_one.c **** 		DIR dir;
 451              		.loc 1 101 3 is_stmt 1 view .LVU104
 102:Core/Src/colir_one.c **** 		uint32_t currentReadAdress = CONFIG_SIZE;
 452              		.loc 1 102 3 view .LVU105
 453              	.LVL23:
 103:Core/Src/colir_one.c **** 		FR_Status = f_opendir(&dir, SDPath);
 454              		.loc 1 103 3 view .LVU106
 104:Core/Src/colir_one.c **** 		if(FR_Status == FR_OK) {
 455              		.loc 1 104 3 view .LVU107
 104:Core/Src/colir_one.c **** 		if(FR_Status == FR_OK) {
 456              		.loc 1 104 15 is_stmt 0 view .LVU108
 457 001c 2E49     		ldr	r1, .L37
 458 001e 03A8     		add	r0, sp, #12
 459 0020 FFF7FEFF 		bl	f_opendir
 460              	.LVL24:
 104:Core/Src/colir_one.c **** 		if(FR_Status == FR_OK) {
 461              		.loc 1 104 13 view .LVU109
 462 0024 2E4B     		ldr	r3, .L37+8
 463 0026 1870     		strb	r0, [r3]
 105:Core/Src/colir_one.c **** 			if(w25qxx.spiHandle->State != HAL_SPI_STATE_READY)
 464              		.loc 1 105 3 is_stmt 1 view .LVU110
 105:Core/Src/colir_one.c **** 			if(w25qxx.spiHandle->State != HAL_SPI_STATE_READY)
 465              		.loc 1 105 5 is_stmt 0 view .LVU111
 466 0028 0028     		cmp	r0, #0
ARM GAS  /tmp/ccjM7rvG.s 			page 12


 467 002a 4ED1     		bne	.L23
 106:Core/Src/colir_one.c **** 				HAL_SPI_Init(w25qxx.spiHandle);
 468              		.loc 1 106 4 is_stmt 1 view .LVU112
 106:Core/Src/colir_one.c **** 				HAL_SPI_Init(w25qxx.spiHandle);
 469              		.loc 1 106 13 is_stmt 0 view .LVU113
 470 002c 2D4B     		ldr	r3, .L37+12
 471 002e 1868     		ldr	r0, [r3]
 106:Core/Src/colir_one.c **** 				HAL_SPI_Init(w25qxx.spiHandle);
 472              		.loc 1 106 23 view .LVU114
 473 0030 90F85130 		ldrb	r3, [r0, #81]	@ zero_extendqisi2
 474 0034 DBB2     		uxtb	r3, r3
 106:Core/Src/colir_one.c **** 				HAL_SPI_Init(w25qxx.spiHandle);
 475              		.loc 1 106 6 view .LVU115
 476 0036 012B     		cmp	r3, #1
 477 0038 01D1     		bne	.L34
 478              	.L24:
 479              	.LBE2:
  98:Core/Src/colir_one.c **** 	FR_Status = f_mount(&SDFatFS, SDPath, 1);
 480              		.loc 1 98 23 discriminator 1 view .LVU116
 481 003a 0125     		movs	r5, #1
 482 003c 16E0     		b	.L25
 483              	.L34:
 484              	.LBB7:
 107:Core/Src/colir_one.c **** 
 485              		.loc 1 107 5 is_stmt 1 view .LVU117
 486 003e FFF7FEFF 		bl	HAL_SPI_Init
 487              	.LVL25:
 488 0042 FAE7     		b	.L24
 489              	.LVL26:
 490              	.L26:
 491              	.LBB3:
 492              	.LBB4:
 113:Core/Src/colir_one.c **** 
 493              		.loc 1 113 6 view .LVU118
 113:Core/Src/colir_one.c **** 
 494              		.loc 1 113 18 is_stmt 0 view .LVU119
 495 0044 D3F80080 		ldr	r8, [r3]
 496              	.LVL27:
 497              	.L27:
 115:Core/Src/colir_one.c **** 				memset(&fileName, 0, sizeof(fileName));
 498              		.loc 1 115 5 is_stmt 1 view .LVU120
 116:Core/Src/colir_one.c **** 				sprintf(fileName, "%d.txt", i);
 499              		.loc 1 116 5 view .LVU121
 500 0048 0023     		movs	r3, #0
 501 004a 0193     		str	r3, [sp, #4]
 502 004c 0293     		str	r3, [sp, #8]
 117:Core/Src/colir_one.c **** 				FR_Status = f_open(&SDFile, fileName, FA_WRITE | FA_READ | FA_CREATE_ALWAYS);
 503              		.loc 1 117 5 view .LVU122
 504 004e 2A46     		mov	r2, r5
 505 0050 2549     		ldr	r1, .L37+16
 506 0052 01A8     		add	r0, sp, #4
 507 0054 FFF7FEFF 		bl	sprintf
 508              	.LVL28:
 118:Core/Src/colir_one.c **** 				if(FR_Status == FR_OK){
 509              		.loc 1 118 5 view .LVU123
 118:Core/Src/colir_one.c **** 				if(FR_Status == FR_OK){
 510              		.loc 1 118 17 is_stmt 0 view .LVU124
ARM GAS  /tmp/ccjM7rvG.s 			page 13


 511 0058 0B22     		movs	r2, #11
 512 005a 01A9     		add	r1, sp, #4
 513 005c 2348     		ldr	r0, .L37+20
 514 005e FFF7FEFF 		bl	f_open
 515              	.LVL29:
 118:Core/Src/colir_one.c **** 				if(FR_Status == FR_OK){
 516              		.loc 1 118 15 view .LVU125
 517 0062 1F4B     		ldr	r3, .L37+8
 518 0064 1870     		strb	r0, [r3]
 119:Core/Src/colir_one.c **** 					currentReadAdress = logs_config->log_address[i - 1];
 519              		.loc 1 119 5 is_stmt 1 view .LVU126
 119:Core/Src/colir_one.c **** 					currentReadAdress = logs_config->log_address[i - 1];
 520              		.loc 1 119 7 is_stmt 0 view .LVU127
 521 0066 70B1     		cbz	r0, .L35
 522              	.L28:
 119:Core/Src/colir_one.c **** 					currentReadAdress = logs_config->log_address[i - 1];
 523              		.loc 1 119 7 view .LVU128
 524              	.LBE4:
 109:Core/Src/colir_one.c **** 				if(i < logs_config->last_log)
 525              		.loc 1 109 52 is_stmt 1 discriminator 2 view .LVU129
 526 0068 0135     		adds	r5, r5, #1
 527              	.LVL30:
 109:Core/Src/colir_one.c **** 				if(i < logs_config->last_log)
 528              		.loc 1 109 52 is_stmt 0 discriminator 2 view .LVU130
 529 006a EDB2     		uxtb	r5, r5
 530              	.LVL31:
 531              	.L25:
 109:Core/Src/colir_one.c **** 				if(i < logs_config->last_log)
 532              		.loc 1 109 25 is_stmt 1 discriminator 1 view .LVU131
 109:Core/Src/colir_one.c **** 				if(i < logs_config->last_log)
 533              		.loc 1 109 39 is_stmt 0 discriminator 1 view .LVU132
 534 006c 204B     		ldr	r3, .L37+24
 535 006e 1B68     		ldr	r3, [r3]
 536 0070 93F88420 		ldrb	r2, [r3, #132]	@ zero_extendqisi2
 109:Core/Src/colir_one.c **** 				if(i < logs_config->last_log)
 537              		.loc 1 109 25 discriminator 1 view .LVU133
 538 0074 AA42     		cmp	r2, r5
 539 0076 24D3     		bcc	.L36
 540              	.LBB6:
 110:Core/Src/colir_one.c **** 					lastAddress = logs_config->log_address[i];
 541              		.loc 1 110 5 is_stmt 1 view .LVU134
 110:Core/Src/colir_one.c **** 					lastAddress = logs_config->log_address[i];
 542              		.loc 1 110 7 is_stmt 0 view .LVU135
 543 0078 AA42     		cmp	r2, r5
 544 007a E3D9     		bls	.L26
 111:Core/Src/colir_one.c **** 				else
 545              		.loc 1 111 6 is_stmt 1 view .LVU136
 111:Core/Src/colir_one.c **** 				else
 546              		.loc 1 111 18 is_stmt 0 view .LVU137
 547 007c 03EB8503 		add	r3, r3, r5, lsl #2
 548 0080 D3F80480 		ldr	r8, [r3, #4]
 549              	.LVL32:
 111:Core/Src/colir_one.c **** 				else
 550              		.loc 1 111 18 view .LVU138
 551 0084 E0E7     		b	.L27
 552              	.L35:
 120:Core/Src/colir_one.c **** 					for(uint32_t address = currentReadAdress; address < lastAddress; address += LOG_SIZE){
ARM GAS  /tmp/ccjM7rvG.s 			page 14


 553              		.loc 1 120 6 is_stmt 1 view .LVU139
 120:Core/Src/colir_one.c **** 					for(uint32_t address = currentReadAdress; address < lastAddress; address += LOG_SIZE){
 554              		.loc 1 120 37 is_stmt 0 view .LVU140
 555 0086 1A4B     		ldr	r3, .L37+24
 556 0088 1B68     		ldr	r3, [r3]
 120:Core/Src/colir_one.c **** 					for(uint32_t address = currentReadAdress; address < lastAddress; address += LOG_SIZE){
 557              		.loc 1 120 53 view .LVU141
 558 008a 6A1E     		subs	r2, r5, #1
 120:Core/Src/colir_one.c **** 					for(uint32_t address = currentReadAdress; address < lastAddress; address += LOG_SIZE){
 559              		.loc 1 120 24 view .LVU142
 560 008c 03EB8203 		add	r3, r3, r2, lsl #2
 561 0090 5C68     		ldr	r4, [r3, #4]
 562              	.LVL33:
 121:Core/Src/colir_one.c **** 						w25qxx_read(&w25qxx, address, (uint8_t*)&buf, sizeof(buf));
 563              		.loc 1 121 6 is_stmt 1 view .LVU143
 564              	.LBB5:
 121:Core/Src/colir_one.c **** 						w25qxx_read(&w25qxx, address, (uint8_t*)&buf, sizeof(buf));
 565              		.loc 1 121 10 view .LVU144
 121:Core/Src/colir_one.c **** 						w25qxx_read(&w25qxx, address, (uint8_t*)&buf, sizeof(buf));
 566              		.loc 1 121 6 is_stmt 0 view .LVU145
 567 0092 10E0     		b	.L29
 568              	.LVL34:
 569              	.L30:
 122:Core/Src/colir_one.c **** 						f_puts(&buf, &SDFile);
 570              		.loc 1 122 7 is_stmt 1 discriminator 3 view .LVU146
 571 0094 174F     		ldr	r7, .L37+28
 572 0096 2023     		movs	r3, #32
 573 0098 3A46     		mov	r2, r7
 574 009a 2146     		mov	r1, r4
 575 009c 1148     		ldr	r0, .L37+12
 576 009e FFF7FEFF 		bl	w25qxx_read
 577              	.LVL35:
 123:Core/Src/colir_one.c **** 						f_puts(&end_of_the_line, &SDFile);
 578              		.loc 1 123 7 discriminator 3 view .LVU147
 579 00a2 124E     		ldr	r6, .L37+20
 580 00a4 3146     		mov	r1, r6
 581 00a6 3846     		mov	r0, r7
 582 00a8 FFF7FEFF 		bl	f_puts
 583              	.LVL36:
 124:Core/Src/colir_one.c **** 					}
 584              		.loc 1 124 7 discriminator 3 view .LVU148
 585 00ac 3146     		mov	r1, r6
 586 00ae 1248     		ldr	r0, .L37+32
 587 00b0 FFF7FEFF 		bl	f_puts
 588              	.LVL37:
 121:Core/Src/colir_one.c **** 						w25qxx_read(&w25qxx, address, (uint8_t*)&buf, sizeof(buf));
 589              		.loc 1 121 79 discriminator 3 view .LVU149
 590 00b4 2034     		adds	r4, r4, #32
 591              	.LVL38:
 592              	.L29:
 121:Core/Src/colir_one.c **** 						w25qxx_read(&w25qxx, address, (uint8_t*)&buf, sizeof(buf));
 593              		.loc 1 121 56 discriminator 1 view .LVU150
 594 00b6 A045     		cmp	r8, r4
 595 00b8 ECD8     		bhi	.L30
 121:Core/Src/colir_one.c **** 						w25qxx_read(&w25qxx, address, (uint8_t*)&buf, sizeof(buf));
 596              		.loc 1 121 56 is_stmt 0 discriminator 1 view .LVU151
 597              	.LBE5:
ARM GAS  /tmp/ccjM7rvG.s 			page 15


 126:Core/Src/colir_one.c **** 				}
 598              		.loc 1 126 6 is_stmt 1 view .LVU152
 599 00ba 0C48     		ldr	r0, .L37+20
 600 00bc FFF7FEFF 		bl	f_close
 601              	.LVL39:
 602 00c0 D2E7     		b	.L28
 603              	.LVL40:
 604              	.L36:
 126:Core/Src/colir_one.c **** 				}
 605              		.loc 1 126 6 is_stmt 0 view .LVU153
 606              	.LBE6:
 607              	.LBE3:
 129:Core/Src/colir_one.c **** 		}
 608              		.loc 1 129 4 is_stmt 1 view .LVU154
 609 00c2 084B     		ldr	r3, .L37+12
 610 00c4 1868     		ldr	r0, [r3]
 611 00c6 FFF7FEFF 		bl	HAL_SPI_DeInit
 612              	.LVL41:
 613              	.L23:
 131:Core/Src/colir_one.c **** 	}
 614              		.loc 1 131 3 view .LVU155
 615 00ca 0022     		movs	r2, #0
 616 00cc 1146     		mov	r1, r2
 617 00ce 0348     		ldr	r0, .L37+4
 618 00d0 FFF7FEFF 		bl	f_mount
 619              	.LVL42:
 620              	.LBE7:
 621              		.loc 1 133 1 is_stmt 0 view .LVU156
 622 00d4 9FE7     		b	.L21
 623              	.L38:
 624 00d6 00BF     		.align	2
 625              	.L37:
 626 00d8 00000000 		.word	SDPath
 627 00dc 00000000 		.word	SDFatFS
 628 00e0 00000000 		.word	FR_Status
 629 00e4 00000000 		.word	w25qxx
 630 00e8 00000000 		.word	.LC0
 631 00ec 00000000 		.word	SDFile
 632 00f0 00000000 		.word	logs_config
 633 00f4 00000000 		.word	buf
 634 00f8 00000000 		.word	end_of_the_line
 635              		.cfi_endproc
 636              	.LFE139:
 638              		.section	.text.reset_logs,"ax",%progbits
 639              		.align	1
 640              		.global	reset_logs
 641              		.syntax unified
 642              		.thumb
 643              		.thumb_func
 645              	reset_logs:
 646              	.LFB140:
 134:Core/Src/colir_one.c **** 
 135:Core/Src/colir_one.c **** void reset_logs(){
 647              		.loc 1 135 18 is_stmt 1 view -0
 648              		.cfi_startproc
 649              		@ args = 0, pretend = 0, frame = 0
 650              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  /tmp/ccjM7rvG.s 			page 16


 651 0000 38B5     		push	{r3, r4, r5, lr}
 652              	.LCFI6:
 653              		.cfi_def_cfa_offset 16
 654              		.cfi_offset 3, -16
 655              		.cfi_offset 4, -12
 656              		.cfi_offset 5, -8
 657              		.cfi_offset 14, -4
 136:Core/Src/colir_one.c **** 	if(w25qxx.spiHandle->State != HAL_SPI_STATE_READY)
 658              		.loc 1 136 2 view .LVU158
 659              		.loc 1 136 11 is_stmt 0 view .LVU159
 660 0002 174B     		ldr	r3, .L45
 661 0004 1868     		ldr	r0, [r3]
 662              		.loc 1 136 21 view .LVU160
 663 0006 90F85130 		ldrb	r3, [r0, #81]	@ zero_extendqisi2
 664 000a DBB2     		uxtb	r3, r3
 665              		.loc 1 136 4 view .LVU161
 666 000c 012B     		cmp	r3, #1
 667 000e 18D1     		bne	.L43
 668              	.L40:
 137:Core/Src/colir_one.c **** 		HAL_SPI_Init(w25qxx.spiHandle);
 138:Core/Src/colir_one.c **** 
 139:Core/Src/colir_one.c **** 	w25qxx_chip_erase(&w25qxx);
 669              		.loc 1 139 2 is_stmt 1 view .LVU162
 670 0010 134D     		ldr	r5, .L45
 671 0012 2846     		mov	r0, r5
 672 0014 FFF7FEFF 		bl	w25qxx_chip_erase
 673              	.LVL43:
 140:Core/Src/colir_one.c **** 	w25qxx_read(&w25qxx, 0, (uint8_t*)&config_buf, sizeof(config_buf));
 674              		.loc 1 140 2 view .LVU163
 675 0018 124C     		ldr	r4, .L45+4
 676 001a 4FF40063 		mov	r3, #2048
 677 001e 2246     		mov	r2, r4
 678 0020 0021     		movs	r1, #0
 679 0022 2846     		mov	r0, r5
 680 0024 FFF7FEFF 		bl	w25qxx_read
 681              	.LVL44:
 141:Core/Src/colir_one.c **** 
 142:Core/Src/colir_one.c **** 	logs_config = (flash_config*)config_buf;
 682              		.loc 1 142 2 view .LVU164
 683              		.loc 1 142 14 is_stmt 0 view .LVU165
 684 0028 0F4B     		ldr	r3, .L45+8
 685 002a 1C60     		str	r4, [r3]
 143:Core/Src/colir_one.c **** 	if(logs_config->last_log == 0 || logs_config->last_log == 255){
 686              		.loc 1 143 2 is_stmt 1 view .LVU166
 687              		.loc 1 143 16 is_stmt 0 view .LVU167
 688 002c 94F88430 		ldrb	r3, [r4, #132]	@ zero_extendqisi2
 689              		.loc 1 143 32 view .LVU168
 690 0030 013B     		subs	r3, r3, #1
 691 0032 DBB2     		uxtb	r3, r3
 692              		.loc 1 143 4 view .LVU169
 693 0034 FD2B     		cmp	r3, #253
 694 0036 07D8     		bhi	.L44
 695              	.L41:
 144:Core/Src/colir_one.c **** 		logs_config->last_log = 0;
 145:Core/Src/colir_one.c **** 		logs_config->last_address = CONFIG_SIZE;
 146:Core/Src/colir_one.c **** 		memset(&logs_config->log_address, 0, sizeof(logs_config->log_address));
 147:Core/Src/colir_one.c **** 	}
ARM GAS  /tmp/ccjM7rvG.s 			page 17


 148:Core/Src/colir_one.c **** 	HAL_SPI_DeInit(w25qxx.spiHandle);
 696              		.loc 1 148 2 is_stmt 1 view .LVU170
 697 0038 094B     		ldr	r3, .L45
 698 003a 1868     		ldr	r0, [r3]
 699 003c FFF7FEFF 		bl	HAL_SPI_DeInit
 700              	.LVL45:
 149:Core/Src/colir_one.c **** }
 701              		.loc 1 149 1 is_stmt 0 view .LVU171
 702 0040 38BD     		pop	{r3, r4, r5, pc}
 703              	.L43:
 137:Core/Src/colir_one.c **** 
 704              		.loc 1 137 3 is_stmt 1 view .LVU172
 705 0042 FFF7FEFF 		bl	HAL_SPI_Init
 706              	.LVL46:
 707 0046 E3E7     		b	.L40
 708              	.L44:
 144:Core/Src/colir_one.c **** 		logs_config->last_log = 0;
 709              		.loc 1 144 3 view .LVU173
 144:Core/Src/colir_one.c **** 		logs_config->last_log = 0;
 710              		.loc 1 144 25 is_stmt 0 view .LVU174
 711 0048 2046     		mov	r0, r4
 712 004a 0021     		movs	r1, #0
 713 004c 84F88410 		strb	r1, [r4, #132]
 145:Core/Src/colir_one.c **** 		memset(&logs_config->log_address, 0, sizeof(logs_config->log_address));
 714              		.loc 1 145 3 is_stmt 1 view .LVU175
 145:Core/Src/colir_one.c **** 		memset(&logs_config->log_address, 0, sizeof(logs_config->log_address));
 715              		.loc 1 145 29 is_stmt 0 view .LVU176
 716 0050 4FF40063 		mov	r3, #2048
 717 0054 40F8043B 		str	r3, [r0], #4
 146:Core/Src/colir_one.c **** 	}
 718              		.loc 1 146 3 is_stmt 1 view .LVU177
 719 0058 8022     		movs	r2, #128
 720 005a FFF7FEFF 		bl	memset
 721              	.LVL47:
 722 005e EBE7     		b	.L41
 723              	.L46:
 724              		.align	2
 725              	.L45:
 726 0060 00000000 		.word	w25qxx
 727 0064 00000000 		.word	config_buf
 728 0068 00000000 		.word	logs_config
 729              		.cfi_endproc
 730              	.LFE140:
 732              		.section	.text.get_logs_config,"ax",%progbits
 733              		.align	1
 734              		.global	get_logs_config
 735              		.syntax unified
 736              		.thumb
 737              		.thumb_func
 739              	get_logs_config:
 740              	.LFB141:
 150:Core/Src/colir_one.c **** 
 151:Core/Src/colir_one.c **** flash_config* get_logs_config() {
 741              		.loc 1 151 33 view -0
 742              		.cfi_startproc
 743              		@ args = 0, pretend = 0, frame = 0
 744              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  /tmp/ccjM7rvG.s 			page 18


 745              		@ link register save eliminated.
 152:Core/Src/colir_one.c **** 	return logs_config;
 746              		.loc 1 152 2 view .LVU179
 153:Core/Src/colir_one.c **** }
 747              		.loc 1 153 1 is_stmt 0 view .LVU180
 748 0000 014B     		ldr	r3, .L48
 749 0002 1868     		ldr	r0, [r3]
 750 0004 7047     		bx	lr
 751              	.L49:
 752 0006 00BF     		.align	2
 753              	.L48:
 754 0008 00000000 		.word	logs_config
 755              		.cfi_endproc
 756              	.LFE141:
 758              		.global	end_of_the_line
 759              		.section	.data.end_of_the_line,"aw"
 760              		.align	2
 763              	end_of_the_line:
 764 0000 0A00     		.ascii	"\012\000"
 765              		.global	FR_Status
 766              		.section	.bss.FR_Status,"aw",%nobits
 769              	FR_Status:
 770 0000 00       		.space	1
 771              		.global	res
 772              		.section	.bss.res,"aw",%nobits
 775              	res:
 776 0000 00       		.space	1
 777              		.global	log_buf_counter
 778              		.section	.bss.log_buf_counter,"aw",%nobits
 779              		.align	1
 782              	log_buf_counter:
 783 0000 0000     		.space	2
 784              		.global	current_address
 785              		.section	.bss.current_address,"aw",%nobits
 786              		.align	2
 789              	current_address:
 790 0000 00000000 		.space	4
 791              		.global	current_log
 792              		.section	.data.current_log,"aw"
 795              	current_log:
 796 0000 FF       		.byte	-1
 797              		.global	logs_buf_counter
 798              		.section	.bss.logs_buf_counter,"aw",%nobits
 801              	logs_buf_counter:
 802 0000 00       		.space	1
 803              		.global	logs_config
 804              		.section	.bss.logs_config,"aw",%nobits
 805              		.align	2
 808              	logs_config:
 809 0000 00000000 		.space	4
 810              		.global	config_buf
 811              		.section	.bss.config_buf,"aw",%nobits
 812              		.align	2
 815              	config_buf:
 816 0000 00000000 		.space	2048
 816      00000000 
 816      00000000 
ARM GAS  /tmp/ccjM7rvG.s 			page 19


 816      00000000 
 816      00000000 
 817              		.global	log_buf
 818              		.section	.bss.log_buf,"aw",%nobits
 819              		.align	2
 822              	log_buf:
 823 0000 00000000 		.space	1024
 823      00000000 
 823      00000000 
 823      00000000 
 823      00000000 
 824              		.global	buf
 825              		.section	.bss.buf,"aw",%nobits
 826              		.align	2
 829              	buf:
 830 0000 00000000 		.space	32
 830      00000000 
 830      00000000 
 830      00000000 
 830      00000000 
 831              		.global	flash_size
 832              		.section	.bss.flash_size,"aw",%nobits
 833              		.align	2
 836              	flash_size:
 837 0000 00000000 		.space	4
 838              		.global	sectors
 839              		.section	.bss.sectors,"aw",%nobits
 840              		.align	2
 843              	sectors:
 844 0000 00000000 		.space	4
 845              		.global	w25qxx
 846              		.section	.bss.w25qxx,"aw",%nobits
 847              		.align	2
 850              	w25qxx:
 851 0000 00000000 		.space	40
 851      00000000 
 851      00000000 
 851      00000000 
 851      00000000 
 852              		.text
 853              	.Letext0:
 854              		.file 2 "/opt/st/stm32cubeclt_1.16.0/GNU-tools-for-STM32/arm-none-eabi/include/machine/_default_ty
 855              		.file 3 "/opt/st/stm32cubeclt_1.16.0/GNU-tools-for-STM32/arm-none-eabi/include/sys/_stdint.h"
 856              		.file 4 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f407xx.h"
 857              		.file 5 "/opt/st/stm32cubeclt_1.16.0/GNU-tools-for-STM32/lib/gcc/arm-none-eabi/12.3.1/include/stdd
 858              		.file 6 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
 859              		.file 7 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 860              		.file 8 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_spi.h"
 861              		.file 9 "Core/Inc/w25qxx.h"
 862              		.file 10 "Middlewares/Third_Party/FatFs/src/integer.h"
 863              		.file 11 "Middlewares/Third_Party/FatFs/src/ff.h"
 864              		.file 12 "FATFS/App/fatfs.h"
 865              		.file 13 "Core/Inc/colir_one.h"
 866              		.file 14 "/opt/st/stm32cubeclt_1.16.0/GNU-tools-for-STM32/arm-none-eabi/include/stdio.h"
 867              		.file 15 "/opt/st/stm32cubeclt_1.16.0/GNU-tools-for-STM32/arm-none-eabi/include/string.h"
 868              		.file 16 "<built-in>"
 869              		.file 17 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal.h"
ARM GAS  /tmp/ccjM7rvG.s 			page 20


ARM GAS  /tmp/ccjM7rvG.s 			page 21


DEFINED SYMBOLS
                            *ABS*:00000000 colir_one.c
     /tmp/ccjM7rvG.s:21     .text.colir_one_init:00000000 $t
     /tmp/ccjM7rvG.s:27     .text.colir_one_init:00000000 colir_one_init
     /tmp/ccjM7rvG.s:135    .text.colir_one_init:0000007c $d
     /tmp/ccjM7rvG.s:850    .bss.w25qxx:00000000 w25qxx
     /tmp/ccjM7rvG.s:775    .bss.res:00000000 res
     /tmp/ccjM7rvG.s:843    .bss.sectors:00000000 sectors
     /tmp/ccjM7rvG.s:836    .bss.flash_size:00000000 flash_size
     /tmp/ccjM7rvG.s:815    .bss.config_buf:00000000 config_buf
     /tmp/ccjM7rvG.s:808    .bss.logs_config:00000000 logs_config
     /tmp/ccjM7rvG.s:146    .text.log_data:00000000 $t
     /tmp/ccjM7rvG.s:152    .text.log_data:00000000 log_data
     /tmp/ccjM7rvG.s:386    .text.log_data:00000148 $d
     /tmp/ccjM7rvG.s:782    .bss.log_buf_counter:00000000 log_buf_counter
     /tmp/ccjM7rvG.s:822    .bss.log_buf:00000000 log_buf
     /tmp/ccjM7rvG.s:789    .bss.current_address:00000000 current_address
     /tmp/ccjM7rvG.s:795    .data.current_log:00000000 current_log
     /tmp/ccjM7rvG.s:398    .rodata.read_logs_to_sd.str1.4:00000000 $d
     /tmp/ccjM7rvG.s:402    .text.read_logs_to_sd:00000000 $t
     /tmp/ccjM7rvG.s:408    .text.read_logs_to_sd:00000000 read_logs_to_sd
     /tmp/ccjM7rvG.s:626    .text.read_logs_to_sd:000000d8 $d
     /tmp/ccjM7rvG.s:769    .bss.FR_Status:00000000 FR_Status
     /tmp/ccjM7rvG.s:829    .bss.buf:00000000 buf
     /tmp/ccjM7rvG.s:763    .data.end_of_the_line:00000000 end_of_the_line
     /tmp/ccjM7rvG.s:639    .text.reset_logs:00000000 $t
     /tmp/ccjM7rvG.s:645    .text.reset_logs:00000000 reset_logs
     /tmp/ccjM7rvG.s:726    .text.reset_logs:00000060 $d
     /tmp/ccjM7rvG.s:733    .text.get_logs_config:00000000 $t
     /tmp/ccjM7rvG.s:739    .text.get_logs_config:00000000 get_logs_config
     /tmp/ccjM7rvG.s:754    .text.get_logs_config:00000008 $d
     /tmp/ccjM7rvG.s:760    .data.end_of_the_line:00000000 $d
     /tmp/ccjM7rvG.s:770    .bss.FR_Status:00000000 $d
     /tmp/ccjM7rvG.s:776    .bss.res:00000000 $d
     /tmp/ccjM7rvG.s:779    .bss.log_buf_counter:00000000 $d
     /tmp/ccjM7rvG.s:786    .bss.current_address:00000000 $d
     /tmp/ccjM7rvG.s:801    .bss.logs_buf_counter:00000000 logs_buf_counter
     /tmp/ccjM7rvG.s:802    .bss.logs_buf_counter:00000000 $d
     /tmp/ccjM7rvG.s:805    .bss.logs_config:00000000 $d
     /tmp/ccjM7rvG.s:812    .bss.config_buf:00000000 $d
     /tmp/ccjM7rvG.s:819    .bss.log_buf:00000000 $d
     /tmp/ccjM7rvG.s:826    .bss.buf:00000000 $d
     /tmp/ccjM7rvG.s:833    .bss.flash_size:00000000 $d
     /tmp/ccjM7rvG.s:840    .bss.sectors:00000000 $d
     /tmp/ccjM7rvG.s:847    .bss.w25qxx:00000000 $d

UNDEFINED SYMBOLS
w25qxx_init
w25qxx_read
HAL_SPI_DeInit
HAL_SPI_Init
memset
w25qxx_erase
HAL_Delay
w25qxx_write
memcpy
f_mount
ARM GAS  /tmp/ccjM7rvG.s 			page 22


f_opendir
sprintf
f_open
f_puts
f_close
SDPath
SDFatFS
SDFile
w25qxx_chip_erase
